name: intel_brief_v1_2
artifact_type: intel_brief
rules:
  required_text_fields:
    - bluf
    - background
    - evidence_and_indicators

  placeholder_values:
    - "unknown"
    - "tbd"
    - "todo"
    - "not applicable"
    - "n/a"
    - "none"

  # v1.2 keeps the same target, but supports best-effort tactic->technique expansion
  min_list_lengths:
    observed_mitre_techniques: 5

  # Optional: if present, this is used to enrich MITRE techniques (best-effort).
  # Not required and does not block approval if missing.
  allowed_lists:
    observed_tactics:
      - initial_access
      - execution
      - persistence
      - privilege_escalation
      - defense_evasion
      - credential_access
      - discovery
      - lateral_movement
      - command_and_control
      - exfiltration
      - impact

  semantic_anchors:
    background:
      min: 2
      anchors: []
      patterns:
        - "(?i)\\b(initial access|execution|persistence|privilege escalation|defense evasion|credential access|discovery|lateral movement|command and control|exfiltration|impact)\\b"
        - "(?i)\\b(campaign|operator|intrusion|activity|tradecraft|malware|ransomware)\\b"

    evidence_and_indicators:
      min: 1
      anchors: []
      patterns:
        - "\\bObserved MITRE Techniques\\b"
        - "\\bCVE-\\d{4}-\\d{4,7}\\b"
        - "\\b[A-Fa-f0-9]{64}\\b"
        - "\\b(?:hxxp|hxxps)://"
        - "\\b[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\\[\\.\\]|\\.)[a-z0-9-]{1,63}(?:\\[\\.\\]|\\.)[a-z]{2,24}\\b"
        - "\\b\\d{1,3}(?:\\[\\.\\]|\\.)\\d{1,3}(?:\\[\\.\\]|\\.)\\d{1,3}(?:\\[\\.\\]|\\.)\\d{1,3}(?::\\d{1,5})?\\b"

    gaps_and_collection:
      min: 0
      anchors: []
      patterns: []

    alternative_analysis:
      min: 0
      anchors: []
      patterns: []

    appendix:
      min: 0
      anchors: []
      patterns: []
