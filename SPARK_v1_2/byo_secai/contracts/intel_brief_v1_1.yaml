name: intel_brief_v1_1
artifact_type: intel_brief
rules:
  required_text_fields:
    - bluf
    - background
    - evidence_and_indicators

  placeholder_values:
    - "unknown"
    - "tbd"
    - "todo"
    - "not applicable"
    - "n/a"
    - "none"

  # v1 strictness: require at least 5 technique IDs unless fail-open is enabled
  min_list_lengths:
    observed_mitre_techniques: 5

  semantic_anchors:
    background:
      min: 2
      anchors: []
      patterns:
        - "(?i)\\b(initial access|execution|persistence|privilege escalation|defense evasion|credential access|discovery|lateral movement|command and control|exfiltration|impact)\\b"
        - "(?i)\\b(campaign|operator|intrusion|activity|tradecraft|malware|ransomware)\\b"

    evidence_and_indicators:
      # Best-effort in v1 (keep low to avoid brittle failures)
      min: 1
      anchors: []
      patterns:
        - "\\bObserved MITRE Techniques\\b"
        - "\\bCVE-\\d{4}-\\d{4,7}\\b"
        - "\\b[A-Fa-f0-9]{64}\\b"
        - "\\b(?:hxxp|hxxps)://"
        - "\\b[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\\[\\.\\]|\\.)[a-z0-9-]{1,63}(?:\\[\\.\\]|\\.)[a-z]{2,24}\\b"
        - "\\b\\d{1,3}(?:\\[\\.\\]|\\.)\\d{1,3}(?:\\[\\.\\]|\\.)\\d{1,3}(?:\\[\\.\\]|\\.)\\d{1,3}(?::\\d{1,5})?\\b"

    gaps_and_collection:
      # Best-effort (non-blocking) in v1
      min: 0
      anchors: []
      patterns: []

    alternative_analysis:
      # Best-effort (non-blocking) in v1
      min: 0
      anchors: []
      patterns: []

    appendix:
      # Best-effort (non-blocking) in v1
      min: 0
      anchors: []
      patterns: []
