# ADS: {{TOPIC}} – Malicious Execution, LSASS Access, and Lateral Movement Tradecraft

**ID:** ads_490170046f  
**Linked Finding:** finding_bce0b55f5d_1  

---

## Goal

Detect recurrence of LockBit ransomware tradecraft prior to encryption impact.

---

## Categorization

**Tactics**
- Credential Access
- Lateral Movement
- Defense Evasion
- Execution

**Techniques**
- T1003.001 – LSASS Memory
- T1055 – Process Injection
- T1036.005 – Masquerading
- T1053.005 – Scheduled Task
- T1021.001 – RDP
- T1021.002 – SMB / Admin Shares

---

## Strategy Abstract

Correlate high-confidence process execution signals with DNS and outbound network telemetry to attribute command-and-control and ransomware staging behavior to specific process contexts.

Escalate when:
- Execution originates from user-writable paths
- Unsigned or masqueraded binaries are observed
- Process lineage indicates hands-on-keyboard activity
- Network destinations align with known proxy or C2 infrastructure

---

## Telemetry Requirements

- `ProcessRollup2`
- `NetworkConnectIP4`
- `DnsRequest`
- SHA256 file hashes
- Parent/child process context

---

## Blind Spots

- Missing or tampered EDR telemetry
- Heavily obfuscated or fileless techniques
- Novel tooling without observable process artifacts

---

## False Positives

Possible from:
- Internal admin tools
- Red team activity
- Unsigned enterprise utilities

Mitigate using signer, path, and parent-process allowlists.

---

## Validation

- Test using safe ransomware simulations
- Confirm telemetry joins and attribution logic
- Tune against benign enterprise activity

---

## Response

- Deploy initially as hunt logic
- Promote to alerting detection once tuned
- Escalate confirmed activity to Incident Response

---

*Generated by SPARK (Powered by BYO-SEcAI)*

## Environment (Simulation)
{{ENVIRONMENT}}

## Query Starters (from Hunt Package)
These are included for demo walkthrough purposes. In full SPARK (Local Mode), queries are refined and validated by the analyst before promotion.


**Query 1**
```crowdstrike
#event_simpleName=ProcessRollup2
| in(field=SHA256HashData, values=[...])
| groupBy([@timestamp, ComputerName, UserName, FileName, FilePath, ImageFileName,
           CommandLine, ParentBaseFileName, ParentCommandLine, SHA256HashData],
          limit=20000)
IOC — File Names
#event_simpleName=ProcessRollup2
| in(field=FileName, values=['check.exe','ds.exe','setup_wm.exe',
                             'svchosts.exe','svcmc.dll','svcmcc.dll'])
| groupBy([...], limit=20000)
IOC — Network Connections (IP:Port)
#event_simpleName=NetworkConnectIP4
((RemoteAddressIP4="159.100.14.254" and RPort=443) OR ...)
| groupBy([...], limit=20000)
Behavioral Correlation — Process ↔ DNS
(#event_simpleName=ProcessRollup2 OR #event_simpleName=DnsRequest) event_platform=Win
| case{
    TargetProcessId="*" | falconPID:=TargetProcessId;
    ContextProcessId="*" | falconPID:=ContextProcessId;
}
| selfJoinFilter([aid, falconPID], ...)
```

## 5. Findings
### 5.1 Summary
No findings recorded yet. Execute a Run to generate Findings.

### 5.2 Technical Findings
Pending execution.

## 6. Analyst Guidance
Use Section 4 queries to validate hypotheses.
Escalate confirmed malicious activity into Findings and promote validated behaviors into an ADS.

## 7. Reporting Summary
Threat: LockBit Ransomware
Status: Draft
Next Step: Execute hunt queries and record findings

Generated by SPARK (Powered by BYO-SEcAI)

## Run Context (Simulation)
**Run ID:** {{RUN_ID}}
**Time Window:** {{TIME_WINDOW}}
**Telemetry:** {{DATA_SOURCES}}


## Response Playbook (Simulation)
Use this section as a **starter checklist** for responding to detected activity. In Local Mode, this would be tailored to your environment and playbooks.

### 1. **Triage & validate**
   - Confirm signal quality (false positive vs true positive).
   - Review process tree, command line, hashes, and network connections.
### 2. **Contain**
   - Isolate affected host(s) if ransomware execution is suspected.
   - Disable or reset compromised accounts / tokens.
### 3. **Preserve evidence**
   - Collect endpoint triage (process list, autoruns, scheduled tasks, persistence).
   - Acquire relevant logs (EDR, DNS, proxy, identity, firewall).
### 4. **Scope**
   - Identify additional impacted hosts/users via lateral movement indicators and shared IOCs/behavior.
   - Look for the same parent/child patterns and C2 infrastructure across the fleet.
### 5. **Eradicate & recover**
   - Remove persistence, block known infrastructure, and patch exposed entry points.
   - Restore systems from known-good backups and validate integrity.
### 6. **Post-incident**
   - Document findings and update detections (ADS), tuning for your telemetry and thresholds.
